<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="summerpetstore.repository.mapper.AuctionMapper">   
  <cache />
  
	<!-- searchAuciton : 경매 검색-->
	<select id="searchAuction" parameterType="String" resultType="summerstore.model.Auction">
		SELECT #{auctionId}, #{dday}, #{astatus}, #{minprice}
		FROM auction
		WHERE astatus = #{astatus}
	</select>
	<!-- 완료와 취소됨도 있어야할 것 같긴함 -->
	
	<!-- showInfo : 경매 자세히 보기-->
	<select id="showInfo" parameterType="int" resultType="summerstore.model.Auction">
		SELECT #{auctionId}, #{dday}, #{astatus}, #{minprice}, #{curMaxPrice}, #{firstId}
		FROM auction
		WHERE auctionId = #{auctionId}
	</select>
	
	<!--showJPList : 입찰자 목록(랭킹) 보여주기 (join person)-->
	<select id="showJPList" parameterType="int" resultType="summerstore.model.AuctionJP">
		SELECT #{auctionId}, #{offerPrice}, #{userId}
		FROM AuctionJP
		WHERE auctionId = #{auctionId}
	</select>
	
	<!--registerAuction : 경매 등록하기-->
	<insert id="order" >
		INSERT INTO OrderItem
		VALUES (#{itemName}, #{itemId}, #{quantity}, #{orderId})
	</insert>
	
	<!--updateAuction : 경매 수정하기-->
	<select id="countItemId" resultType="int" >
		SELECT COUNT(#{itemId}) 
		FROM Cart
		WHERE userId = #{userId}
	</select>

	<!--deleteAuction : 경매 삭제하기-->
	<update id="incrementquantity">
		UPDATE cart
		SET quantity = quantity + 1
		WHERE itemId = #{itemId} and userId = #{userId}
		''
	</update>
	
	<!--bid : 입찰하기-->
	<!--updateBid : 입찰가 수정-->
	<!--deleteBid : 입찰 자체 취소-->
	<!--tossSucBid : 낙찰자가 2일안에 결제를 진행하지 않을 시, 자동으로2등 가격을 제시한 사람의 장바구니로 토스됨 -->
	<!--sucBid : 낙찰 경매 종료일이 되면 제일 높은 가격을 제시한 입찰자의 장바구니에 자동으로 담김-->
	

</mapper>